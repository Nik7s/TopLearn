@page "{userId}"
@model TopLearn.Web.Pages.Admin.Users.EditUserModel
@{
    ViewData["Title"] = "ویرایش کاربر";
}

<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">ویرایش کاربر</h1>
    </div>
</div>

<div class="row">
    <form method="post" enctype="multipart/form-data">
        <div class="col-md-8">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    اطلاعات کاربر
                </div>
                <div class="panel-body">
                    <div class="form-group">
                        <label>نام کاربری : </label>
                        <input type="text" required asp-for="EditUserViewModel.UserName" class="form-control" value="@Model.EditUserViewModel.UserName">
                    </div>
                    <div class="form-group">
                        <label>ایمیل : </label>
                        <input type="email" required asp-for="EditUserViewModel.Email" class="form-control" value="@Model.EditUserViewModel.Email">
                        <span asp-validation-for="EditUserViewModel.Email" style="font-size: 1.5rem" class="alert-danger"></span>
                    </div>
                    <div class="form-group">
                        <label>کلمه عبور : </label>
                        <input type="text" asp-for="EditUserViewModel.Password" class="form-control">
                        <span style="font-size: 1.5rem" class="alert-warning">کلمه عبور را به منظور تغییر کلمه عبور وارد کنید . در صورت وارد نکردن کلمه عبور , تغییری صورت نمی گیرد .  </span>
                    </div>
                    <div class="form-group">
                        <label>فعال : </label>
                        @if (Model.EditUserViewModel.IsActive)
                        {
                            <input type="checkbox" checked asp-for="EditUserViewModel.IsActive" class="">
                        }
                        else
                        {
                            <input type="checkbox" asp-for="EditUserViewModel.IsActive" class="">
                        }
                    </div>
                    <div class="form-group">
                        <label>نقش های کاربر</label>
                        @foreach (var role in Model.EditUserViewModel.Roles)
                        {
                            @if (Model.EditUserViewModel.SelectedRole == role.RoleId)
                            {
                                <div class="radio">
                                    <label>
                                        <input type="radio" checked required name="SelectedRole" value="@role.RoleId"> @role.RoleTitle
                                        </label>
                                </div>
                            }
                            else
                            {
                                <div class="radio">
                                    <label>
                                        <input type="radio" required name="SelectedRole" value="@role.RoleId"> @role.RoleTitle
                                    </label>
                                </div>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading" style="font-size: 2rem">
                    تصویر پروفایل
                </div>
                <div class="panel-body">
                    <label id="color" style="font-size: 18px; width: fit-content">
                        <input asp-for="EditUserViewModel.OldAvatar" checked id="CheckBox" style="font-size: 18px;" type="checkbox"> ادامه با عکس پروفایل قبلی
                    </label>
                    <p></p>
                    <p></p>
                    <img id="img" class="thumbnail" style="width: 250px; max-width: 250px" src="/UserAvatar/@(Model.EditUserViewModel.CurrentAvatar)" />
                    <br />
                    <img id="uploadPreview" class="thumbnail" style="width: 250px; max-width: 250px" src="" />
                    <br />
                    <input asp-for="EditUserViewModel.UserAvatar" id="File" type="file" onchange="PreviewImage()" class="form-control">
                    <br />
                    <span asp-validation-for="EditUserViewModel.UserAvatar" style="font-size: 1.5rem" class="alert-danger"></span>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading" style="font-size: 2rem">
                    ویرایش اطلاعات
                </div>
                <div class="panel-body">
                    <div class="row col-md-12">
                        <p style="text-align: center">
                            <input style="font-size: 2rem; width: 60%;" type="submit" value="ویرایش" class="btn btn-success" />
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<script>
    var checkbox = document.getElementById("CheckBox");
    var color = document.getElementById("color");
    var file = document.getElementById("File");
    var img = document.getElementById("img");
    var uploadPreview = document.getElementById("uploadPreview");

    if (checkbox.checked == true) {
        file.disabled = true;
        file.value = "";
        color.style.color = 'black';
        uploadPreview.style.display = "none";
        uploadPreview.src = "";
        img.style.display = "block";
    }

    if (checkbox.checked == false) {
        file.disabled = false;
        color.style.color = 'gray';
        uploadPreview.style.display = "block";
        img.style.display = "none";
    }


    checkbox.addEventListener("click", () => {
        file = document.getElementById("File");

        if (checkbox.checked == true) {
            img.style.display = "block";
            color.style.color = 'black';
            file.disabled = true;
            uploadPreview.src = "";
            file.value = "";
            uploadPreview.style.display = "none";
        }
        if (checkbox.checked == false) {
            img.style.display = "none";
            color.style.color = 'gray';
            uploadPreview.style.display = "block";
            file.disabled = false;
        }
    });


</script>

<script type="text/javascript">

    function PreviewImage() {
        var oFReader = new FileReader();
        oFReader.readAsDataURL(document.getElementById("File").files[0]);

        oFReader.onload = function (oFREvent) {
            document.getElementById("uploadPreview").src = oFREvent.target.result;
        };
    };

</script>